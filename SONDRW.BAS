'ESCAPE DRAW***************************
SCREEN 13: CLS
SVEF = 0
TOTPP = 0
X = 0: Y = 0: C = 1: CURCC = 0
LX = 4: LY = 4
LINE (-1, -1)-(LX + 1, LY + 1), 1, B
BC:
A$ = INKEY$
IF A$ = CHR$(0) + "H" GOTO UP
IF A$ = CHR$(0) + "P" GOTO DOWN
IF A$ = CHR$(0) + "K" GOTO LEFT
IF A$ = CHR$(0) + "M" GOTO RIGHT
IF A$ = "O" OR A$ = "o" THEN GOTO OPTIONS
IF A$ = " " GOTO DRAWCOL
IF A$ = "S" THEN GOTO SVE
IF A$ = "L" THEN GOTO LD
IF A$ = "Q" GOTO QUIT
IF A$ = "-" THEN GOTO DL
GOTO BC

UP:
IF Y - 1 < 0 THEN GOTO BC
COLD = CURCC
CURCC = POINT(X, Y - 1)
Y = Y - 1
PSET (X, Y), 2
PSET (X, Y + 1), COLD
LOCATE 23, 1: PRINT X; " "; Y; " "
GOTO BC

DOWN:
IF Y + 1 > LY + 1 THEN GOTO BC
COLD = CURCC
CURCC = POINT(X, Y + 1)
Y = Y + 1
PSET (X, Y), 2
PSET (X, Y - 1), COLD
LOCATE 23, 1: PRINT X; " "; Y; " "
GOTO BC

LEFT:
IF X - 1 < 0 THEN GOTO BC
COLD = CURCC
CURCC = POINT(X - 1, Y)
X = X - 1
PSET (X, Y), 2
PSET (X + 1, Y), COLD
LOCATE 23, 1: PRINT X; " "; Y; " "
GOTO BC

RIGHT:
IF X + 1 > LX + 1 THEN GOTO BC
COLD = CURCC
CURCC = POINT(X + 1, Y)
X = X + 1
PSET (X, Y), 2
PSET (X - 1, Y), COLD
LOCATE 23, 1: PRINT X; " "; Y; " "
GOTO BC

OPTIONS:
COLOR 1

LOCATE 20, 1: INPUT "COLOR TO USE"; C
LOCATE 20, 1: PRINT "                   "
GOTO BC

DRAWCOL:
PSET (X, Y), C
CURCC = C
IF L = 1 THEN GOTO DL2
IF SVEF = 1 THEN GOTO SVE2
GOTO BC

SVE:
BEEP
SVEF = 1
STARTNUMX = 0: STARTNUMY = 0
GOTO BC

SVE2:
LOCATE 23, 1: INPUT "FILENAME? "; FI$
LOCATE 23, 1: PRINT "                                  "
ENDNUMX = LX: ENDNUMY = LY
LOCATE 23, 1: PRINT "PLEASE WAIT... SAVING...   "
MFI$ = "C:\ESCAPE\GFX\" + FI$ + ".GFX"
OPEN MFI$ FOR OUTPUT AS #1
FOR J = STARTNUMY TO ENDNUMY
FOR K = STARTNUMX TO ENDNUMX
SP = POINT(K, J)
IF SP = 0 THEN GOTO NR
IF SP = 2 THEN GOTO RR
PRINT #1, K, J, SP
GOTO NR
RR:
PRINT #1, K, J, COLD
NR:
NEXT
NEXT
CLOSE
SVEF = 0
LOCATE 23, 1: PRINT "                           "
GOTO BC

LD:
LOCATE 23, 1: INPUT "FILENAME? "; FL$
LOCATE 23, 1: PRINT "                      "
CLS
TOTPP = 0
MFL$ = "C:\ESCAPE\GFX\" + FL$ + ".GFX"
OPEN MFL$ FOR INPUT AS #1
RSL:
ON ERROR GOTO E
INPUT #1, J, K, C
PSET (J, K), C
GOTO RSL
E:
RESUME 12
12 CLOSE
LINE (-1, -1)-(LX + 1, LY + 1), 1, B
GOTO BC

DL:
L = 1
LOCATE 23, 1: PRINT "LINE TO?"
X1 = X: Y1 = Y
GOTO BC

DL2:
L = 0
LOCATE 23, 1: PRINT "        "
X2 = X: Y2 = Y
LINE (X1, Y1)-(X2, Y2), C
GOTO BC

QUIT:




